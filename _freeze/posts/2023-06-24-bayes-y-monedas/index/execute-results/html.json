{
  "hash": "80b8d4079b07cb6a617da2b028791d3b",
  "result": {
    "markdown": "---\ntitle: \"Cara o cruz, modo Bayes (I)\"\ndescription: \"Experimentos estadísticos frecuentistas y bayesianos en lanzamiento de monedas.\"\ndescription-meta: \"Experimentos estadísticos frecuentistas y bayesianos en lanzamiento de monedas.\"\nauthor: \"Leonardo Hansa\"\ndate: \"2023-06-24\"\ncategories: [datos]\nexecute: \n  echo: false\nfreeze: auto\n---\n\n\n\n\nTienes una moneda, aparentemente no trucada, y la lanzas **100 veces.**\n\nEsperarías que 50 veces saliera cara, ¿no? Más o menos.\n\nPues sale **60 veces.**\n\n¿Sigues pensando que no está trucada?\n\n\n::: {.cell}\n\n:::\n\n\n## El modo frecuentista\n\nPuedes plantear el problema así: \n\n- Realizas el experimento 10.000 veces. \n- O sea, lanzas la moneda 100 veces y cuentas, las caras; lo haces otra vez; y otra... y así 10.000 veces.\n\n¿Cuántas de esas veces has obtenido por lo menos 60 caras?\n\nLas que marco en el gráfico:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/frequentist-1.png){width=672}\n:::\n:::\n\n\nEsa área es el p-valor de este test: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom.test(heads, flips, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tExact binomial test\n\ndata:  heads and flips\nnumber of successes = 60, number of trials = 100, p-value = 0.02844\nalternative hypothesis: true probability of success is greater than 0.5\n95 percent confidence interval:\n 0.5129758 1.0000000\nsample estimates:\nprobability of success \n                   0.6 \n```\n:::\n:::\n\n\n\n## ¿Qué hay mal aquí?\n\nLo malo de esto es que ese planteamiento te da la probabilidad de tus datos, en el supuesto de que la moneda no esté trucada (muy baja, por cierto). \n\nPero es que tú no quieres eso. \n\nTú ya lanzaste la moneda 100 veces, y salió cara 60. No quieres la probabilidad de que eso ocurra... ¡porque eso ya ha ocurrido!\n\nLo que quieres saber es si es probable o no que la moneda esté trucada. \n\nSi no lo está, la probabilidad de obtener cara es 0,5. \n\nAhora bien, dado que has obtenido cara 60 veces de 100, ¿cuál es probabilidad real de obtener cara en esa moneda?\n\n## El modo bayesiano\n\n### Priori\nSupón que no tienes ni idea de si la moneda está trucada o no. O sea, la probabilida de obtener cara va entre 0 y 1. \n\nSí, normalmente es 0,5, pero como ahora no sabes nada de la moneda, vas a suponer que puedes obtener cara siempre, o nunca, o pocas veces, o muchas... pues eso, cualquier número entre 0 y 1.\n\nEl siguiente gráfico es una aproximación a cómo expresamos eso visualmente. La idea es que la probabilidad de obtener cara sigue una distribución uniforme entre 0 y 1. \n\nEso es tu **información a priori**: no tienes ni idea.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/priori-1.png){width=672}\n:::\n:::\n\n\n### Modelo generativo\n\nAhora vas a simular varias situaciones de lanzamientos de la moneda 100 veces. Pero en cada experimento, la probabilidad de obtener cara varía, según la distribución uniforme que has asumido antes. \n\nEsta es la distribución del número de caras que obtienes en este caso: \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/gen-mod-1.png){width=672}\n:::\n:::\n\n\n\nVisto así, parece poca cosa, pero ya tienes la información suficiente para tener mejor idea de la probabilidad de obtener cara.\n\n### Posteriori\n\nPrimero, construyes una tabla en la que tienes el número de caras obtenido en función de la probabilidad de obtener cara.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n    p_priori number_of_heads\n1 0.38332002              44\n2 0.42683854              42\n3 0.82601385              84\n4 0.05691333               2\n5 0.21326502              21\n6 0.43819212              50\n```\n:::\n:::\n\n\n\nEn esa tabla podemos quedarnos solo con los casos en los que obtienes 60 caras. Y en esos casos observas la probabilidad de obtener cara. \n\nEsa probabilidad sigue esta distribución: \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/posteriori1-1.png){width=672}\n:::\n:::\n\n\nSi prefieres números: \n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.4668  0.5714  0.5992  0.5987  0.6310  0.7095 \n```\n:::\n:::\n\n\nEsos números ya no siguen la distribución uniforme a priori de antes, en la que indicabas que no sabías nada de la moneda. \n\nAhora ya sabes entre qué números puede variar esa probabilidad.\n\n### Datos\n\nEsos valores a posteriori los hemos calculado porque en tu experimento inicial conseguiste 60 caras. \n\nPero si tus datos fueran otros, tu modelo generativo te permite obtener el posteriori de nuevo. \n\nSolo tienes que moverte entre los resultados. \n\nAquí tienes, visualmente, en qué consiste la creación de los posteriori, dados los datos:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/marginal-1.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}